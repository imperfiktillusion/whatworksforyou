<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>NZ Medicinal Cannabis Product Terpene Comparison</title>
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600&display=swap" rel="stylesheet">
<style>
  body {
    font-family: 'Poppins', sans-serif;
    margin: 0;
    padding: 20px;
  }
  h1 {
    font-size: 16px;
    margin: 0 0 4px 0;
  }
  h2 {
    font-size: 10px;
    margin: 0 0 12px 0;
    font-weight: 400;
  }
  table {
    border-collapse: collapse;
    width: 100%;
    font-size: 0.8rem;
  }
  th, td {
    border: 1px solid #ccc;
    padding: 4px;
    text-align: center;
    white-space: nowrap;
    word-wrap: break-word;
  }
  th {
    cursor: pointer;
    background-color: #f4f4f4;
    position: sticky;
    top: 0;
    z-index: 3;
    border-bottom: 2px solid #999;
    line-height: 1.2em;
    max-width: 80px;
  }
  td:first-child, th:first-child {
    position: sticky;
    left: 0;
    background-color: #f4f4f4;
    text-align: left;
    z-index: 5; /* raised for mobile */
    cursor: pointer; /* indicate clickability */
  }
  td:last-child, th:last-child {
    text-align: left;
  }
  td.shaded {
    color: #000;
    width: 80px; 
  }
  /* highlight effect */
  tr.highlight {
    background-color: rgba(255, 215, 0, 0.25) !important;
  }
  /* italic rows */
  tr.italicised {
    font-style: italic;
  }
</style>
</head>
<body>

<h1>NZ Medicinal Cannabis Product Terpene Comparison - approx % w/w</h1>
<h2>List of products taken from the <a href="https://www.health.govt.nz/regulation-legislation/medicinal-cannabis/information-for-health-professionals/minimum-quality-standard-medicinal-cannabis-products" style=text-decoration: underline;" target="_blank">Ministry of Health list of Medicinal cannabis products that meet the minimum quality standard</a>, Product data taken from crowd sourced supplier published Product Data Information Sheets <br>Click column headers to sort. Where total terpenes data was unavailable terpene values have been normalised to 1% w/w.</h2>

<table id="spreadsheet">
  <thead>
    <tr id="headerRow"></tr>
  </thead>
  <tbody id="tableBody"></tbody>
</table>

<script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.4.1/papaparse.min.js"></script>
<script>
// CSV URL
const csvUrl = "https://docs.google.com/spreadsheets/d/e/2PACX-1vTww6fpAXf2v9iAoHDaMmlT44fgIggpFPAKubK9xRsDQfpdnquC3JYt2sL54Mn6Bgl-ld3jjQR7QIXP/pub?gid=869048094&single=true&output=csv";

let tableData = [];
let sortDirections = [];
let highlightedRow = null; // track currently highlighted row

// Load CSV
fetch(csvUrl)
  .then(res => res.text())
  .then(text => {
    tableData = Papa.parse(text, {header: false}).data;
    buildTable();
  });

// Build table
function buildTable() {
  const headerRow = document.getElementById('headerRow');
  const tableBody = document.getElementById('tableBody');
  headerRow.innerHTML = '';
  tableBody.innerHTML = '';

  // Filter rows with empty first column
  let bodyData = tableData.slice(1).filter(r => r[0] && r[0].trim() !== '');

  // Initialize sort directions
  sortDirections = new Array(tableData[0].length).fill(null);

  // Header
  tableData[0].forEach((col, index) => {
    const th = document.createElement('th');
    th.textContent = col;
    th.addEventListener('click', () => sortColumn(index));
    headerRow.appendChild(th);
  });

  renderTableBody(bodyData);
}

// Render table
