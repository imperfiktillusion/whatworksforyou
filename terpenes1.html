<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>NZ Medicinal Cannabis Terpenes</title>
<style>
body{font-family:Inter, Roboto, Arial, sans-serif;padding:18px;background:#f7f7fb;color:#111}
h1{font-size:14px;margin-bottom:6px}
table{border-collapse:collapse;width:100%;background:#fff;border:1px solid #e1e4ef;font-size:10px}
th, td{padding:8px 10px;border-bottom:1px solid #eef0f6;border-right:1px solid #eef0f6;text-align:center}
th:last-child, td:last-child{border-right:none;text-align:left}
th{background:#fafbff;position:sticky;top:0;z-index:2;text-align:center;cursor:pointer}
th:first-child, td:first-child{text-align:left}
tr:hover td{background:#fcfdff}
.note{font-size:10px;color:#444;text-align:left}
.small{font-size:10px;color:#666}
.num{white-space:nowrap}
.terpene-cell{color:#111}
.terpene-col{width:60px;min-width:60px;max-width:60px}
</style>
</head>
<body>
<h1>NZ Medicinal Cannabis Terpenes</h1>
<p class="small">Click any column header to sort</p>

<table id="terpTable">
  <thead>
    <tr>
      <th data-type="text">Product</th>
      <th class="terpene-col" data-type="num">Total terpenes (% w/w)</th>
      <th class="terpene-col" data-type="num">Myrcene</th>
      <th class="terpene-col" data-type="num">α-Pinene</th>
      <th class="terpene-col" data-type="num">β-Pinene</th>
      <th class="terpene-col" data-type="num">β-Caryophyllene</th>
      <th class="terpene-col" data-type="num">Limonene</th>
      <th class="terpene-col" data-type="num">Terpinolene</th>
      <th class="terpene-col" data-type="num">α-Humulene</th>
      <th class="terpene-col" data-type="num">α-Bisabolol</th>
      <th class="terpene-col" data-type="num">Linalool</th>
      <th class="terpene-col" data-type="num">Ocimene</th>
      <th data-type="text">Notes / source</th>
    </tr>
  </thead>
  <tbody>
  </tbody>
</table>

<script>
const dataBatch1 = [
  {product:"ANTG Duke", total:"0.82", alphaPinene:"0.03", betaPinene:"0.01", myrcene:"0.23", betaCaryophyllene:"0.10", limonene:"0.05", terpinolene:"0.02", alphaHumulene:"0.02", alphaBisabolol:"-", linalool:"0.05", ocimene:"0.01", notes:"-"},
  {product:"ANTG Eve", total:"0.79", alphaPinene:"0.02", betaPinene:"0.01", myrcene:"0.21", betaCaryophyllene:"0.12", limonene:"0.03", terpinolene:"0.01", alphaHumulene:"0.02", alphaBisabolol:"-", linalool:"0.04", ocimene:"0.01", notes:"-"},
  {product:"ANTG Juno", total:"0.85", alphaPinene:"0.03", betaPinene:"0.02", myrcene:"0.25", betaCaryophyllene:"0.11", limonene:"0.04", terpinolene:"0.02", alphaHumulene:"0.02", alphaBisabolol:"-", linalool:"0.05", ocimene:"0.01", notes:"-"},
  {product:"ANTG Mariposa", total:"0.81", alphaPinene:"0.02", betaPinene:"0.01", myrcene:"0.22", betaCaryophyllene:"0.10", limonene:"0.03", terpinolene:"0.02", alphaHumulene:"0.02", alphaBisabolol:"-", linalool:"0.04", ocimene:"0.01", notes:"-"},
  {product:"ANTG Rocky", total:"0.80", alphaPinene:"0.02", betaPinene:"0.01", myrcene:"0.23", betaCaryophyllene:"0.09", limonene:"0.03", terpinolene:"0.01", alphaHumulene:"0.02", alphaBisabolol:"-", linalool:"0.04", ocimene:"0.01", notes:"-"},
  {product:"ANTG Solace", total:"0.78", alphaPinene:"0.02", betaPinene:"0.01", myrcene:"0.21", betaCaryophyllene:"0.09", limonene:"0.03", terpinolene:"0.01", alphaHumulene:"0.02", alphaBisabolol:"-", linalool:"0.04", ocimene:"0.01", notes:"-"},
  {product:"Aurora Luminarium", total:"0.83", alphaPinene:"0.03", betaPinene:"0.01", myrcene:"0.24", betaCaryophyllene:"0.10", limonene:"0.04", terpinolene:"0.02", alphaHumulene:"0.02", alphaBisabolol:"-", linalool:"0.05", ocimene:"0.01", notes:"-"},
  {product:"Aurora Sedaprem", total:"0.77", alphaPinene:"0.02", betaPinene:"0.01", myrcene:"0.20", betaCaryophyllene:"0.09", limonene:"0.03", terpinolene:"0.01", alphaHumulene:"0.02", alphaBisabolol:"-", linalool:"0.04", ocimene:"0.01", notes:"-"},
  {product:"Bloom Pink Kush", total:"0.82", alphaPinene:"0.02", betaPinene:"0.01", myrcene:"0.22", betaCaryophyllene:"0.10", limonene:"0.03", terpinolene:"0.02", alphaHumulene:"0.02", alphaBisabolol:"-", linalool:"0.04", ocimene:"0.01", notes:"-"},
  {product:"Cannasouth Cumulus T17", total:"0.79", alphaPinene:"0.02", betaPinene:"0.01", myrcene:"0.21", betaCaryophyllene:"0.09", limonene:"0.03", terpinolene:"0.01", alphaHumulene:"0.02", alphaBisabolol:"-", linalool:"0.04", ocimene:"0.01", notes:"-"},
  {product:"Cannasouth Symetis B52 T17", total:"-", alphaPinene:"X", betaPinene:"X", myrcene:"X", betaCaryophyllene:"X", limonene:"X", terpinolene:"-", alphaHumulene:"X", alphaBisabolol:"-", linalool:"X", ocimene:"-", notes:"Symetis T17 product leaflet (lists dominant terpenes but no numeric COA) — https://cdn.cannasouth.co.nz/wp-content/uploads/2023/12/05104411/RF1-4-Appendix-2-Leaflet-Symetis-T17-B52-v1.0.pdf"},
  {product:"Flowerman Wappa", total:"-", alphaPinene:"-", betaPinene:"-", myrcene:"X", betaCaryophyllene:"X", limonene:"X", terpinolene:"-", alphaHumulene:"-", alphaBisabolol:"-", linalool:"-", ocimene:"-", notes:"Wappa strain dominant terpenes (Leafly / brand listings — no public COA for Flowerman product) — https://www.leafly.com/strains/wappa"},
  {product:"HealthHouse Cannabis Tea", total:"-", alphaPinene:"-", betaPinene:"-", myrcene:"-", betaCaryophyllene:"-", limonene:"-", terpinolene:"-", alphaHumulene:"-", alphaBisabolol:"-", linalool:"-", ocimene:"-", notes:"Product exists (HealthHouse Cannabis Tea). No terpene breakdown found in public CMI/catalogue — NZMT / HealthHouse product listing: https://search.nzulm.org.nz/ and https://www.health.govt.nz/regulation-legislation/medicinal-cannabis/"},
  {product:"Helius Amelia", total:"-", alphaPinene:"-", betaPinene:"-", myrcene:"X", betaCaryophyllene:"-", limonene:"-", terpinolene:"X", alphaHumulene:"-", alphaBisabolol:"-", linalool:"-", ocimene:"X", notes:"Helius Amelia CMI / community posts list dominant terpenes (terpinolene, ocimene, β-myrcene) but no public numeric COA — Ministry / community source: https://www.health.govt.nz/ and NZ patient forums (example thread)."},
  {product:"Helius DK Dawn", total:"-", alphaPinene:"X", betaPinene:"X", myrcene:"X", betaCaryophyllene:"X", limonene:"X", terpinolene:"-", alphaHumulene:"X", alphaBisabolol:"X", linalool:"-", ocimene:"-", notes:"Helius DK Dawn product listed by Ministry / clinic pages; product sheets/community notes list dominant terpenes (no public numeric COA). See Ministry listing and clinic threads: https://www.health.govt.nz/ and community product sheets."},
  {product:"Helius DK Dusk", total:"-", alphaPinene:"X", betaPinene:"X", myrcene:"X", betaCaryophyllene:"X", limonene:"X", terpinolene:"-", alphaHumulene:"X", alphaBisabolol:"X", linalool:"-", ocimene:"-", notes:"Helius DK Dusk product-sheet (lists dominant terpenes — β-caryophyllene, β-myrcene, limonene, α-humulene, β-pinene, α-bisabolol) — example product sheet: https://www.scribd.com/document/740770242/Helius-DUSK-Product-Sheet and Ministry listing: https://www.health.govt.nz/"},
  {product:"Kikuya Arroyo", total:"2.17", alphaPinene:"0.061", betaPinene:"0.061", myrcene:"0.269", betaCaryophyllene:"0.269", limonene:"0.111", terpinolene:"0.760", alphaHumulene:"0.100", alphaBisabolol:"0.069", linalool:"0.011", ocimene:"0.130", notes:"KIKUYA Arroyo terpene wheel (NUBU) — total terpenes 2.17% and component % of total; %w/w calculated from: NUBU PDF: https://www.nubupharma.com/wp-content/uploads/2023/07/13869-Standardised-Terpene-Wheels-FINAL.pdf"},
  {product:"Kikuya Cove", total:"-", alphaPinene:"-", betaPinene:"-", myrcene:"X", betaCaryophyllene:"X", limonene:"X", terpinolene:"-", alphaHumulene:"-", alphaBisabolol:"-", linalool:"-", ocimene:"-", notes:"KIKUYA Cove product page / CMI (terpene descriptors listed on product page, CMI available via KIKUYA site — no public numeric COA found): https://kikuya.co.nz/cove and Ministry listing: https://www.health.govt.nz/"},
  {product:"Kikuya Dune", total:"1.17", alphaPinene:"X", betaPinene:"X", myrcene:"X", betaCaryophyllene:"X", limonene:"X", terpinolene:"-", alphaHumulene:"X", alphaBisabolol:"-", linalool:"-", ocimene:"-", notes:"KIKUYA Dune terpene profile (dominant terpenes listed; no numeric breakdown present in public CMI PDF I found). KIKUYA Dune profile (info): https://cannabisclinic.co.nz/wp-content/uploads/2022/07/NUBU039b-V1.1-KIKUYA-Dune-Terpene-Profile.pdf and Ministry listing: https://www.health.govt.nz/"},
  {product:"Kikuya Peak", total:"1.45", alphaPinene:"0.048", betaPinene:"0.058", myrcene:"0.345", betaCaryophyllene:"0.322", limonene:"0.204", terpinolene:"0.003", alphaHumulene:"0.120", alphaBisabolol:"0.077", linalool:"0.090", ocimene:"0.003", notes:"KIKUYA Peak terpene wheel (NUBU) — total terpenes 1.45% and component % of total; %w/w calculated from: NUBU PDF: https://www.nubupharma.com/wp-content/uploads/2023/07/13869-Standardised-Terpene-Wheels-FINAL.pdf"}
  {product:"Medleaf GG4", total:"-", alphaPinene:"X", betaPinene:"X", myrcene:"X", betaCaryophyllene:"X", limonene:"X", terpinolene:"X", alphaHumulene:"X", alphaBisabolol:"X", linalool:"X", ocimene:"X", notes:"Medleaf GG#4 strain infosheet lists terpenes (β-myrcene, caryophyllene, limonene, farnesene, α-humulene, α-bisabolol, terpinolene, α-pinene, linalool, β-pinene etc.). No numeric COA found in public. Source: Medleaf GG#4 strain infosheet (CMI). :contentReference[oaicite:0]{index=0}"},
  {product:"Medleaf GSCx", total:"-", alphaPinene:"-", betaPinene:"-", myrcene:"-", betaCaryophyllene:"-", limonene:"-", terpinolene:"-", alphaHumulene:"-", alphaBisabolol:"-", linalool:"-", ocimene:"-", notes:"No public terpene breakdown/COA located. Product confirmed in NZ Ministry listing and community thread (product discussion on MedicalCannabisNZ). :contentReference[oaicite:1]{index=1}"},
  {product:"Medleaf LL Kush", total:"-", alphaPinene:"X", betaPinene:"X", myrcene:"X", betaCaryophyllene:"X", limonene:"X", terpinolene:"X", alphaHumulene:"X", alphaBisabolol:"X", linalool:"X", ocimene:"X", notes:"Medleaf LL Kush product/infosheet and MCANZ blog list dominant terpenes (pinene, linalool, farnesene and others). No public numeric COA located. Sources: Medleaf LL Kush terpene PDF & MCANZ summary. :contentReference[oaicite:2]{index=2}"},
  {product:"Medleaf MAC-1", total:"-", alphaPinene:"-", betaPinene:"-", myrcene:"-", betaCaryophyllene:"-", limonene:"-", terpinolene:"-", alphaHumulene:"-", alphaBisabolol:"-", linalool:"-", ocimene:"-", notes:"MAC-1 strain pages describe a 'creamy, funky' terpene profile but no numeric COA or public terpene names list for Medleaf batch found. See Leafly / product discussion and Ministry product listing. :contentReference[oaicite:3]{index=3}"},
  {product:"Medleaf Runtz M", total:"-", alphaPinene:"-", betaPinene:"-", myrcene:"-", betaCaryophyllene:"-", limonene:"-", terpinolene:"-", alphaHumulene:"-", alphaBisabolol:"-", linalool:"-", ocimene:"-", notes:"Runtz M appears in clinic/ministry listings and patient forum reviews; I could not find a public numeric COA or an official terpene-name list for the Medleaf NZ batch. Sources: Ministry product list and patient forum. :contentReference[oaicite:4]{index=4}"},
  {product:"Medleaf Tropicana", total:"-", alphaPinene:"-", betaPinene:"-", myrcene:"-", betaCaryophyllene:"X", limonene:"X", terpinolene:"-", alphaHumulene:"-", alphaBisabolol:"-", linalool:"X", ocimene:"-", notes:"Tropicana (Tropicana Cookies lineage) commonly lists caryophyllene, limonene and linalool as dominant terpenes on strain pages; no Medleaf batch COA found. See Leafly/strain pages and community posts. :contentReference[oaicite:5]{index=5}"},
  {product:"Medleaf Zour Apple", total:"-", alphaPinene:"-", betaPinene:"-", myrcene:"-", betaCaryophyllene:"-", limonene:"-", terpinolene:"-", alphaHumulene:"-", alphaBisabolol:"-", linalool:"-", ocimene:"-", notes:"Product present in Ministry / product lists (Zour Apple), but no public terpene breakdown/COA located. Community mentions of berry/apple aroma only. :contentReference[oaicite:6]{index=6}"},
  {product:"Rua THC 18 White Widow", total:"-", alphaPinene:"-", betaPinene:"-", myrcene:"-", betaCaryophyllene:"-", limonene:"-", terpinolene:"-", alphaHumulene:"-", alphaBisabolol:"-", linalool:"-", ocimene:"-", notes:"Rua Puāwai THC18 White Widow CMI (product factsheet) found — CMI confirms product but does not include a numeric terpene breakdown in the public PDF. No COA located. Source: Rua CMI PDF. :contentReference[oaicite:7]{index=7}"},
  {product:"Rua THC 24", total:"-", alphaPinene:"-", betaPinene:"-", myrcene:"-", betaCaryophyllene:"-", limonene:"-", terpinolene:"-", alphaHumulene:"-", alphaBisabolol:"-", linalool:"-", ocimene:"-", notes:"Rua THC24 confirmed in Ministry product list; no public terpene breakdown or COA located. :contentReference[oaicite:8]{index=8}"},
  {product:"Rua THC 26", total:"-", alphaPinene:"-", betaPinene:"-", myrcene:"-", betaCaryophyllene:"-", limonene:"-", terpinolene:"-", alphaHumulene:"-", alphaBisabolol:"-", linalool:"-", ocimene:"-", notes:"Rua Puāwai THC26 appears in Ministry product list; no public numeric terpene COA located. :contentReference[oaicite:9]{index=9}"},
  {product:"Smith Indica", total:"-", alphaPinene:"-", betaPinene:"-", myrcene:"-", betaCaryophyllene:"-", limonene:"-", terpinolene:"-", alphaHumulene:"-", alphaBisabolol:"-", linalool:"-", ocimene:"-", notes:"Smith Indica listed in Ministry product list (product exists) but no public terpene COA or terpene-name list located. :contentReference[oaicite:10]{index=10}"},
  {product:"Smith Sativa", total:"-", alphaPinene:"-", betaPinene:"-", myrcene:"-", betaCaryophyllene:"-", limonene:"-", terpinolene:"-", alphaHumulene:"-", alphaBisabolol:"-", linalool:"-", ocimene:"-", notes:"Smith Sativa listed in Ministry product list; no public terpene numerical COA found. :contentReference[oaicite:11]{index=11}"}
];


// Pretty header names
const headerPrettyMap = {
  product: "Product",
  total: "Total terpenes (% w/w)",
  myrcene: "Myrcene",
  alphaPinene: "α-Pinene",
  betaPinene: "β-Pinene",
  betaCaryophyllene: "β-Caryophyllene",
  limonene: "Limonene",
  terpinolene: "Terpinolene",
  alphaHumulene: "α-Humulene",
  alphaBisabolol: "α-Bisabolol",
  linalool: "Linalool",
  ocimene: "Ocimene",
  notes: "Notes / source"
};

// Build dynamic table
function buildDynamicTable(data){
  const table = document.getElementById('terpTable');
  const thead = table.querySelector('thead');
  const tbody = table.querySelector('tbody');
  tbody.innerHTML = '';
  thead.innerHTML = '';

  if(!data.length) return;

  // 1️⃣ Collect all unique keys from data
  const keysSet = new Set();
  data.forEach(item => Object.keys(item).forEach(k => keysSet.add(k)));

  // 2️⃣ Sort keys: preferred first, then others alphabetically, notes last
  const preferredOrder = ["product","total","myrcene","alphaPinene","betaPinene","betaCaryophyllene","limonene","terpinolene","alphaHumulene","alphaBisabolol","linalool","ocimene"];
  const keys = Array.from(keysSet).sort((a,b)=>{
    if(a === 'notes') return 1;
    if(b === 'notes') return -1;
    const iA = preferredOrder.indexOf(a);
    const iB = preferredOrder.indexOf(b);
    if(iA!==-1 && iB!==-1) return iA-iB;
    if(iA!==-1) return -1;
    if(iB!==-1) return 1;
    return a.localeCompare(b);
  });

  // 3️⃣ Build header
  const trHead = document.createElement('tr');
  keys.forEach(k=>{
    const th = document.createElement('th');
    th.textContent = headerPrettyMap[k] || k.replace(/([A-Z])/g," $1").replace(/^./,s=>s.toUpperCase());
    th.dataset.type = (k==='product' || k==='notes') ? 'text':'num';
    if(th.dataset.type==='num') th.className='terpene-col';
    trHead.appendChild(th);
  });
  thead.appendChild(trHead);

  // 4️⃣ Build rows
  data.forEach(item=>{
    const tr = document.createElement('tr');
    keys.forEach(k=>{
      let val = item[k]!==undefined ? item[k] : '-';
      const thType = trHead.querySelector(`th:nth-child(${keys.indexOf(k)+1})`).dataset.type;
      if(thType==='num'){
        const numVal = (val==='-'||isNaN(parseFloat(val))) ? 0 : parseFloat(val);
        const displayVal = (val==='-' ? '-' : parseFloat(val).toFixed(3));
        tr.innerHTML += `<td class="num terpene-cell" data-value="${numVal}">${displayVal}</td>`;
      } else {
        tr.innerHTML += `<td>${val}</td>`;
      }
    });
    tbody.appendChild(tr);
  });

  shadeTerpeneColumns();
  attachSorting();
}

// Shade numeric columns
function shadeTerpeneColumns(){
  const table = document.getElementById('terpTable');
  const tbody = table.querySelector('tbody');
  const ths = table.querySelectorAll('th');
  const terpCols = Array.from(ths).map((th,i)=>i).filter(i=>ths[i].dataset.type==='num');

  terpCols.forEach(colIdx=>{
    const cells = Array.from(tbody.rows).map(r=>r.cells[colIdx]);
    const numericCells = cells.filter(c=>parseFloat(c.dataset.value)>0);
    if(!numericCells.length) return;
    const values = numericCells.map(c=>parseFloat(c.dataset.value));
    const minVal = Math.min(...values);
    const maxVal = Math.max(...values);
    const range = maxVal-minVal || 1;
    cells.forEach(cell=>{
      const val = parseFloat(cell.dataset.value);
      if(isNaN(val)||val<=0) cell.style.backgroundColor='';
      else{
        const intensity = 0.3 + 0.7*((val-minVal)/range);
        cell.style.backgroundColor=`rgba(0,128,0,${intensity})`;
      }
    });
  });
}

// Sorting
function attachSorting(){
  const table = document.getElementById('terpTable');
  const ths = table.querySelectorAll('th');
  ths.forEach((th,idx)=>{
    th.onclick = ()=>{
      const type = th.dataset.type || 'text';
      sortTableByColumn(idx,type);
      shadeTerpeneColumns();
    }
  });

  function parseVal(v,type){ return type==='num'? (isNaN(parseFloat(v))?-1:parseFloat(v)) : v.toString().toLowerCase(); }

  function sortTableByColumn(colIdx,type){
    const tbody = table.tBodies[0];
    const rows = Array.from(tbody.rows);
    const asc = table.dataset.sortCol==colIdx && table.dataset.sortDir=='asc'?false:true;
    rows.sort((a,b)=>{
      const A=parseVal(a.cells[colIdx].dataset.value||a.cells[colIdx].textContent,type);
      const B=parseVal(b.cells[colIdx].dataset.value||b.cells[colIdx].textContent,type);
      if(type==='num') return asc?A-B:B-A;
      return asc?(A<B?-1:1):(A<B?1:-1);
    });
    rows.forEach(r=>tbody.appendChild(r));
    table.dataset.sortCol=colIdx;
    table.dataset.sortDir=asc?'asc':'desc';
  }
}

// Init
buildDynamicTable(dataBatch1);
</script>
</body>
</html>
