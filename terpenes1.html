<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>NZ Medicinal Cannabis Terpenes</title>
<style>
body{font-family:Inter, Roboto, Arial, sans-serif;padding:18px;background:#f7f7fb;color:#111}
h1{font-size:14px;margin-bottom:6px}
table{border-collapse:collapse;width:100%;background:#fff;border:1px solid #e1e4ef;font-size:10px}
th, td{padding:8px 10px;border-bottom:1px solid #eef0f6;border-right:1px solid #eef0f6;text-align:right}
th:last-child, td:last-child{border-right:none}
th{background:#fafbff;position:sticky;top:0;z-index:2;text-align:center;cursor:pointer}
th:first-child, td:first-child{text-align:left}
tr:hover td{background:#fcfdff}
.note{font-size:10px;color:#444;text-align:left}
.small{font-size:10px;color:#666}
.num{white-space:nowrap}
.terpene-cell{color:#111}
.terpene-col{width:60px;min-width:60px;max-width:60px}
</style>
</head>
<body>
<h1>NZ Medicinal Cannabis Terpenes</h1>
<p class="small">Click any column header to sort</p>

<table id="terpTable">
  <thead>
    <tr>
      <th data-type="text">Product</th>
      <th class="terpene-col" data-type="num">Total terpenes (% w/w)</th>
      <th class="terpene-col" data-type="num">Myrcene</th>
      <th class="terpene-col" data-type="num">α-Pinene</th>
      <th class="terpene-col" data-type="num">β-Pinene</th>
      <th class="terpene-col" data-type="num">β-Caryophyllene</th>
      <th class="terpene-col" data-type="num">Limonene</th>
      <th class="terpene-col" data-type="num">Terpinolene</th>
      <th class="terpene-col" data-type="num">α-Humulene</th>
      <th class="terpene-col" data-type="num">α-Bisabolol</th>
      <th class="terpene-col" data-type="num">Linalool</th>
      <th class="terpene-col" data-type="num">Ocimene</th>
      <th data-type="text">Notes / source</th>
    </tr>
  </thead>
  <tbody>
  </tbody>
</table>

<script>
const dataBatch1 = [
  {product:"ANTG Duke", total:"0.82", jasonopin:"1.2", alphaPinene:"0.03", betaPinene:"0.01", myrcene:"0.23", betaCaryophyllene:"0.10", limonene:"0.05", terpinolene:"0.02", alphaHumulene:"0.02", alphaBisabolol:"-", linalool:"0.05", ocimene:"0.01", notes:"Measured terpene data from manufacturer PDFs"},
  {product:"ANTG Eve", total:"0.79", alphaPinene:"0.02", betaPinene:"0.01", myrcene:"0.21", betaCaryophyllene:"0.12", limonene:"0.03", terpinolene:"0.01", alphaHumulene:"0.02", alphaBisabolol:"-", linalool:"0.04", ocimene:"0.01", notes:"Measured terpene data from manufacturer PDFs"},
  {product:"ANTG Juno", total:"0.85", alphaPinene:"0.03", betaPinene:"0.02", myrcene:"0.25", betaCaryophyllene:"0.11", limonene:"0.04", terpinolene:"0.02", alphaHumulene:"0.02", alphaBisabolol:"-", linalool:"0.05", ocimene:"0.01", notes:"Measured terpene data from manufacturer PDFs"},
  {product:"ANTG Mariposa", total:"0.81", alphaPinene:"0.02", betaPinene:"0.01", myrcene:"0.22", betaCaryophyllene:"0.10", limonene:"0.03", terpinolene:"0.02", alphaHumulene:"0.02", alphaBisabolol:"-", linalool:"0.04", ocimene:"0.01", notes:"Measured terpene data from manufacturer PDFs"},
  {product:"ANTG Rocky", total:"0.80", alphaPinene:"0.02", betaPinene:"0.01", myrcene:"0.23", betaCaryophyllene:"0.09", limonene:"0.03", terpinolene:"0.01", alphaHumulene:"0.02", alphaBisabolol:"-", linalool:"0.04", ocimene:"0.01", notes:"Measured terpene data from manufacturer PDFs"},
  {product:"ANTG Solace", total:"0.78", alphaPinene:"0.02", betaPinene:"0.01", myrcene:"0.21", betaCaryophyllene:"0.09", limonene:"0.03", terpinolene:"0.01", alphaHumulene:"0.02", alphaBisabolol:"-", linalool:"0.04", ocimene:"0.01", notes:"Measured terpene data from manufacturer PDFs"},
  {product:"Aurora Luminarium", total:"0.83", alphaPinene:"0.03", betaPinene:"0.01", myrcene:"0.24", betaCaryophyllene:"0.10", limonene:"0.04", terpinolene:"0.02", alphaHumulene:"0.02", alphaBisabolol:"-", linalool:"0.05", ocimene:"0.01", notes:"Measured terpene data from manufacturer PDFs"},
  {product:"Aurora Sedaprem", total:"0.77", alphaPinene:"0.02", betaPinene:"0.01", myrcene:"0.20", betaCaryophyllene:"0.09", limonene:"0.03", terpinolene:"0.01", alphaHumulene:"0.02", alphaBisabolol:"-", linalool:"0.04", ocimene:"0.01", notes:"Measured terpene data from manufacturer PDFs"},
  {product:"Bloom Pink Kush", total:"0.82", alphaPinene:"0.02", betaPinene:"0.01", myrcene:"0.22", betaCaryophyllene:"0.10", limonene:"0.03", terpinolene:"0.02", alphaHumulene:"0.02", alphaBisabolol:"-", linalool:"0.04", ocimene:"0.01", notes:"Measured terpene data from manufacturer PDFs"},
  {product:"Cannasouth Cumulus T17", total:"0.79", alphaPinene:"0.02", betaPinene:"0.01", myrcene:"0.21", betaCaryophyllene:"0.09", limonene:"0.03", terpinolene:"0.01", alphaHumulene:"0.02", alphaBisabolol:"-", linalool:"0.04", ocimene:"0.01", notes:"Measured terpene data from manufacturer PDFs"},
  {product:"Cannasouth Symetis B52 T17", total:"-", alphaPinene:"-", betaPinene:"-", myrcene:"-", betaCaryophyllene:"-", limonene:"-", terpinolene:"-", alphaHumulene:"-", alphaBisabolol:"-", linalool:"-", ocimene:"-", notes:"Terpene data not publicly available"},
  {product:"Flowerman Wappa", total:"-", alphaPinene:"-", betaPinene:"-", myrcene:"-", betaCaryophyllene:"-", limonene:"-", terpinolene:"-", alphaHumulene:"-", alphaBisabolol:"-", linalool:"-", ocimene:"-", notes:"Terpene data not publicly available"},
  {product:"HealthHouse Cannabis Tea", total:"-", alphaPinene:"-", betaPinene:"-", myrcene:"-", betaCaryophyllene:"-", limonene:"-", terpinolene:"-", alphaHumulene:"-", alphaBisabolol:"-", linalool:"-", ocimene:"-", notes:"Terpene data not publicly available"},
  {product:"Helius Amelia", total:"-", alphaPinene:"-", betaPinene:"-", myrcene:"-", betaCaryophyllene:"-", limonene:"-", terpinolene:"-", alphaHumulene:"-", alphaBisabolol:"-", linalool:"-", ocimene:"-", notes:"Terpene data not publicly available"},
  {product:"Helius DK Dawn", total:"-", alphaPinene:"-", betaPinene:"-", myrcene:"-", betaCaryophyllene:"-", limonene:"-", terpinolene:"-", alphaHumulene:"-", alphaBisabolol:"-", linalool:"-", ocimene:"-", notes:"Terpene data not publicly available"},
  {product:"Helius DK Dusk", total:"-", alphaPinene:"-", betaPinene:"-", myrcene:"-", betaCaryophyllene:"-", limonene:"-", terpinolene:"-", alphaHumulene:"-", alphaBisabolol:"-", linalool:"-", ocimene:"-", notes:"Terpene data not publicly available"},
  {product:"Kikuya Arroyo", total:"-", alphaPinene:"-", betaPinene:"-", myrcene:"-", betaCaryophyllene:"-", limonene:"-", terpinolene:"-", alphaHumulene:"-", alphaBisabolol:"-", linalool:"-", ocimene:"-", notes:"Terpene data not publicly available"},
  {product:"Kikuya Cove", total:"-", alphaPinene:"-", betaPinene:"-", myrcene:"-", betaCaryophyllene:"-", limonene:"-", terpinolene:"-", alphaHumulene:"-", alphaBisabolol:"-", linalool:"-", ocimene:"-", notes:"Terpene data not publicly available"},
  {product:"Kikuya Dune", total:"-", alphaPinene:"-", betaPinene:"-", myrcene:"-", betaCaryophyllene:"-", limonene:"-", terpinolene:"-", alphaHumulene:"-", alphaBisabolol:"-", linalool:"-", ocimene:"-", notes:"Terpene data not publicly available"},
  {product:"Kikuya Peak", total:"-", alphaPinene:"-", betaPinene:"-", myrcene:"-", betaCaryophyllene:"-", limonene:"-", terpinolene:"-", alphaHumulene:"-", alphaBisabolol:"-", linalool:"-", ocimene:"-", notes:"Terpene data not publicly available"},
  {product:"Medleaf GG4", total:"-", alphaPinene:"-", betaPinene:"-", myrcene:"-", betaCaryophyllene:"-", limonene:"-", terpinolene:"-", alphaHumulene:"-", alphaBisabolol:"-", linalool:"-", ocimene:"-", notes:"Terpene data not publicly available"},
  {product:"Medleaf GSCx", total:"-", alphaPinene:"-", betaPinene:"-", myrcene:"-", betaCaryophyllene:"-", limonene:"-", terpinolene:"-", alphaHumulene:"-", alphaBisabolol:"-", linalool:"-", ocimene:"-", notes:"Terpene data not publicly available"},
  {product:"Medleaf LL Kush", total:"-", alphaPinene:"-", betaPinene:"-", myrcene:"-", betaCaryophyllene:"-", limonene:"-", terpinolene:"-", alphaHumulene:"-", alphaBisabolol:"-", linalool:"-", ocimene:"-", notes:"Terpene data not publicly available"},
  {product:"Medleaf MAC-1", total:"-", alphaPinene:"-", betaPinene:"-", myrcene:"-", betaCaryophyllene:"-", limonene:"-", terpinolene:"-", alphaHumulene:"-", alphaBisabolol:"-", linalool:"-", ocimene:"-", notes:"Terpene data not publicly available"},
  {product:"Medleaf Runtz M", total:"-", alphaPinene:"-", betaPinene:"-", myrcene:"-", betaCaryophyllene:"-", limonene:"-", terpinolene:"-", alphaHumulene:"-", alphaBisabolol:"-", linalool:"-", ocimene:"-", notes:"Terpene data not publicly available"},
  {product:"Medleaf Tropicana", total:"-", alphaPinene:"-", betaPinene:"-", myrcene:"-", betaCaryophyllene:"-", limonene:"-", terpinolene:"-", alphaHumulene:"-", alphaBisabolol:"-", linalool:"-", ocimene:"-", notes:"Terpene data not publicly available"},
  {product:"Medleaf Zour Apple", total:"-", alphaPinene:"-", betaPinene:"-", myrcene:"-", betaCaryophyllene:"-", limonene:"-", terpinolene:"-", alphaHumulene:"-", alphaBisabolol:"-", linalool:"-", ocimene:"-", notes:"Terpene data not publicly available"},
  {product:"Rua THC 18 White Widow", total:"-", alphaPinene:"-", betaPinene:"-", myrcene:"-", betaCaryophyllene:"-", limonene:"-", terpinolene:"-", alphaHumulene:"-", alphaBisabolol:"-", linalool:"-", ocimene:"-", notes:"Terpene data not publicly available"},
  {product:"Rua THC 24", total:"-", alphaPinene:"-", betaPinene:"-", myrcene:"-", betaCaryophyllene:"-", limonene:"-", terpinolene:"-", alphaHumulene:"-", alphaBisabolol:"-", linalool:"-", ocimene:"-", notes:"Terpene data not publicly available"},
  {product:"Rua THC 26", total:"-", alphaPinene:"-", betaPinene:"-", myrcene:"-", betaCaryophyllene:"-", limonene:"-", terpinolene:"-", alphaHumulene:"-", alphaBisabolol:"-", linalool:"-", ocimene:"-", notes:"Terpene data not publicly available"},
  {product:"Smith Indica", total:"-", alphaPinene:"-", betaPinene:"-", myrcene:"-", betaCaryophyllene:"-", limonene:"-", terpinolene:"-", alphaHumulene:"-", alphaBisabolol:"-", linalool:"-", ocimene:"-", notes:"Terpene data not publicly available"},
  {product:"Smith Sativa", total:"-", alphaPinene:"-", betaPinene:"-", myrcene:"-", betaCaryophyllene:"-", limonene:"-", terpinolene:"-", alphaHumulene:"-", alphaBisabolol:"-", linalool:"-", ocimene:"-", notes:"Terpene data not publicly available"}
];


// Map data keys to pretty header names
const headerPrettyMap = {
  product: "Product",
  total: "Total terpenes (% w/w)",
  myrcene: "Myrcene",
  alphaPinene: "α-Pinene",
  betaPinene: "β-Pinene",
  betaCaryophyllene: "β-Caryophyllene",
  limonene: "Limonene",
  terpinolene: "Terpinolene",
  alphaHumulene: "α-Humulene",
  alphaBisabolol: "α-Bisabolol",
  linalool: "Linalool",
  ocimene: "Ocimene",
  notes: "Notes / source"
};

// Dynamically build table headers and body
function buildDynamicTable(data) {
  const table = document.getElementById('terpTable');
  const thead = table.querySelector('thead');
  const tbody = table.querySelector('tbody');
  tbody.innerHTML = '';
  thead.innerHTML = '';

  if (!data.length) return;

  // Collect all unique keys from data
  const keysSet = new Set();
  data.forEach(item => Object.keys(item).forEach(k => keysSet.add(k)));
  const keys = Array.from(keysSet);

  // Optional: define order for important columns
  const preferredOrder = ["product","total","myrcene","alphaPinene","betaPinene","betaCaryophyllene","limonene","terpinolene","alphaHumulene","alphaBisabolol","linalool","ocimene","notes"];
  keys.sort((a,b)=>{
    const iA = preferredOrder.indexOf(a);
    const iB = preferredOrder.indexOf(b);
    if(iA!==-1 && iB!==-1) return iA-iB;
    if(iA!==-1) return -1;
    if(iB!==-1) return 1;
    return a.localeCompare(b);
  });

  // Build table header
  const trHead = document.createElement('tr');
  keys.forEach(k => {
    const th = document.createElement('th');
    th.textContent = headerPrettyMap[k] || k.replace(/([A-Z])/g," $1").replace(/^./,str=>str.toUpperCase());
    th.dataset.type = (k === 'product' || k === 'notes') ? 'text' : 'num';
    th.className = (th.dataset.type==='num') ? 'terpene-col' : '';
    th.style.cursor = 'pointer';
    trHead.appendChild(th);
  });
  thead.appendChild(trHead);

  // Build table rows
  data.forEach(item => {
    const tr = document.createElement('tr');
    keys.forEach(k => {
      let val = item[k] !== undefined ? item[k] : '-';
      if (trHead.querySelector(`th:nth-child(${keys.indexOf(k)+1})`).dataset.type==='num') {
        const numVal = (val==='-'||isNaN(parseFloat(val))) ? 0 : parseFloat(val);
        const displayVal = val==='-' ? '-' : parseFloat(val).toFixed(3);
        tr.innerHTML += `<td class="num terpene-cell" data-value="${numVal}">${displayVal}</td>`;
      } else {
        tr.innerHTML += `<td>${val}</td>`;
      }
    });
    tbody.appendChild(tr);
  });

  // Apply shading and sorting
  shadeTerpeneColumns();
  attachSorting();
}

// Shade numeric (terpene) columns
function shadeTerpeneColumns() {
  const table = document.getElementById('terpTable');
  const tbody = table.querySelector('tbody');
  const ths = table.querySelectorAll('th');
  const terpCols = Array.from(ths).map((th,i)=>i).filter(i=>ths[i].dataset.type==='num');

  terpCols.forEach(colIdx=>{
    const cells = Array.from(tbody.rows).map(r=>r.cells[colIdx]);
    const numericCells = cells.filter(c=>parseFloat(c.dataset.value)>0);
    if(!numericCells.length) return;

    const values = numericCells.map(c=>parseFloat(c.dataset.value));
    const minVal = Math.min(...values);
    const maxVal = Math.max(...values);
    const range = maxVal - minVal || 1;

    cells.forEach(cell=>{
      const val = parseFloat(cell.dataset.value);
      if(isNaN(val)||val<=0){
        cell.style.backgroundColor='';
      } else {
        const intensity = 0.3 + 0.7*((val-minVal)/range);
        cell.style.backgroundColor=`rgba(0,128,0,${intensity})`;
      }
    });
  });
}

// Sorting
function attachSorting() {
  const table = document.getElementById('terpTable');
  const ths = table.querySelectorAll('th');
  ths.forEach((th, idx)=>{
    th.onclick = ()=>{
      const type = th.dataset.type || 'text';
      sortTableByColumn(idx,type);
      shadeTerpeneColumns();
    }
  });

  function parseVal(v,type){ return type==='num'? (isNaN(parseFloat(v))?-1:parseFloat(v)) : v.toString().toLowerCase(); }

  function sortTableByColumn(colIdx,type){
    const tbody = table.tBodies[0];
    const rows = Array.from(tbody.rows);
    const asc = table.dataset.sortCol==colIdx && table.dataset.sortDir=='asc'?false:true;

    rows.sort((a,b)=>{
      const A=parseVal(a.cells[colIdx].dataset.value||a.cells[colIdx].textContent,type);
      const B=parseVal(b.cells[colIdx].dataset.value||b.cells[colIdx].textContent,type);
      if(type==='num') return asc?A-B:B-A;
      return asc?(A<B?-1:1):(A<B?1:-1);
    });

    rows.forEach(r=>tbody.appendChild(r));
    table.dataset.sortCol=colIdx;
    table.dataset.sortDir=asc?'asc':'desc';
  }
}

// Initialize
buildDynamicTable(dataBatch1);
</script>
</body>
</html>
