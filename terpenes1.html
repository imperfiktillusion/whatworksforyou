<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>NZ Medicinal Cannabis Terpenes</title>
<style>
body{font-family:Inter, Roboto, Arial, sans-serif;padding:18px;background:#f7f7fb;color:#111}
h1{font-size:14px;margin-bottom:6px}
table{border-collapse:collapse;width:100%;background:#fff;border:1px solid #e1e4ef;font-size:10px}
th, td{padding:8px 10px;border-bottom:1px solid #eef0f6;border-right:1px solid #eef0f6;text-align:center}
th:last-child, td:last-child{border-right:none;text-align:left}
th{background:#fafbff;position:sticky;top:0;z-index:2;text-align:center;cursor:pointer}
th:first-child, td:first-child{text-align:left}
tr:hover td{background:#fcfdff}
.note{font-size:10px;color:#444;text-align:left}
.small{font-size:10px;color:#666}
.num{white-space:nowrap}
.terpene-cell{color:#111}
.terpene-col{width:60px;min-width:60px;max-width:60px}
</style>
</head>
<body>
<h1>NZ Medicinal Cannabis Terpenes</h1>
<p class="small">Click any column header to sort</p>

<table id="terpTable">
  <thead>
    <tr>
      <th data-type="text">Product</th>
      <th class="terpene-col" data-type="num">Total terpenes (% w/w)</th>
      <th class="terpene-col" data-type="num">Myrcene</th>
      <th class="terpene-col" data-type="num">α-Pinene</th>
      <th class="terpene-col" data-type="num">β-Pinene</th>
      <th class="terpene-col" data-type="num">β-Caryophyllene</th>
      <th class="terpene-col" data-type="num">Limonene</th>
      <th class="terpene-col" data-type="num">Terpinolene</th>
      <th class="terpene-col" data-type="num">α-Humulene</th>
      <th class="terpene-col" data-type="num">α-Bisabolol</th>
      <th class="terpene-col" data-type="num">Linalool</th>
      <th class="terpene-col" data-type="num">Ocimene</th>
      <th data-type="text">Notes / source</th>
    </tr>
  </thead>
  <tbody>
  </tbody>
</table>

<script>
const dataBatch1 = [
  {product:"ANTG Duke", total:"-", alphaPinene:"-", betaPinene:"-", myrcene:"-", betaCaryophyllene:"-", limonene:"-", terpinolene:"-", alphaHumulene:"-", alphaBisabolol:"-", linalool:"-", ocimene:"-", notes:"ANTG Duke CMI (no terpene breakdown found): https://antg.com.au/wp-content/uploads/2023/10/ANTG_Duke_Dried_Cannabis-CMI-SEP23.pdf"},

  {product:"ANTG Eve", total:"0.980", alphaPinene:"0.050", betaPinene:"0.090", myrcene:"0.330", betaCaryophyllene:"0.170", limonene:"0.090", terpinolene:"0.140", alphaHumulene:"-", alphaBisabolol:"-", linalool:"0.040", ocimene:"-", notes:"ANTG standardised terpene wheel (percentage + total used to compute %w/w). Source: Nubu Pharma 'Standardised Terpene Wheels' (ANTG Eve page). PDF: https://www.nubupharma.com/wp-content/uploads/2023/07/13869-Standardised-Terpene-Wheels-FINAL.pdf. Cross-check: ANTG terpenes sheet. https://cannabisclinic.co.nz/wp-content/uploads/2022/02/ANTG_Terpenes.pdf"},

  {product:"ANTG Juno", total:"X", alphaPinene:"-", betaPinene:"-", myrcene:"-", betaCaryophyllene:"X", limonene:"-", terpinolene:"-", alphaHumulene:"X", alphaBisabolol:"-", linalool:"-", ocimene:"-", notes:"No dried-flower terpene COA found. Juno dried-flower COA (potency only): https://myleaf.com.au/assets/ANTG-Juno-COA.pdf. Juno vape product info lists B-caryophyllene and α-humulene (names only; no %): https://antg.com.au/wp-content/uploads/... (ANTG Juno product leaflet / vape PI)"},

  {product:"ANTG Mariposa", total:"0.960", alphaPinene:"0.040", betaPinene:"0.070", myrcene:"0.070", betaCaryophyllene:"0.170", limonene:"0.170", terpinolene:"-", alphaHumulene:"0.080", alphaBisabolol:"-", linalool:"0.070", ocimene:"-", notes:"ANTG standardised terpene wheel (Mariposa). Source (computed): Nubu Pharma terpene wheels PDF. https://www.nubupharma.com/wp-content/uploads/2023/07/13869-Standardised-Terpene-Wheels-FINAL.pdf. Cross-check: ANTG 'terpenes' factsheet re-published by clinics. https://cannabisclinic.co.nz/wp-content/uploads/2022/02/ANTG_Terpenes.pdf"},

  {product:"ANTG Rocky", total:"1.360", alphaPinene:"-", betaPinene:"0.069", myrcene:"0.027", betaCaryophyllene:"0.125", limonene:"0.235", terpinolene:"-", alphaHumulene:"0.056", alphaBisabolol:"-", linalool:"0.069", ocimene:"-", notes:"ANTG standardised terpene wheel (Rocky). Source (computed): Nubu Pharma terpene wheels PDF. https://www.nubupharma.com/wp-content/uploads/2023/07/13869-Standardised-Terpene-Wheels-FINAL.pdf. Cross-check: ANTG materials re-published to clinics. https://cannabisclinic.co.nz/wp-content/uploads/2022/02/ANTG_Terpenes.pdf"},

  {product:"ANTG Solace", total:"2.420", alphaPinene:"-", betaPinene:"0.109", myrcene:"0.409", betaCaryophyllene:"0.290", limonene:"0.431", terpinolene:"-", alphaHumulene:"0.169", alphaBisabolol:"-", linalool:"0.140", ocimene:"-", notes:"ANTG standardised terpene wheel (Solace). Source (computed): Nubu Pharma terpene wheels PDF. https://www.nubupharma.com/wp-content/uploads/2023/07/13869-Standardised-Terpene-Wheels-FINAL.pdf. Cross-check: ANTG terpenes sheet. https://cannabisclinic.co.nz/wp-content/uploads/2022/02/ANTG_Terpenes.pdf"},

  {product:"Aurora Luminarium", total:"X", alphaPinene:"X", betaPinene:"-", myrcene:"X", betaCaryophyllene:"-", limonene:"-", terpinolene:"X", alphaHumulene:"-", alphaBisabolol:"-", linalool:"-", ocimene:"-", notes:"Aurora product pages list main terpenes (terpinolene, b-myrcene, a-pinene) but no numerical COA for NZ-dried flower publicly available. See Aurora product page: https://www.auroramedical.com/products/luminarium-oil-2-0 and Aurora product catalog / factsheets (brand materials)."},

  {product:"Aurora Sedaprem", total:"X", alphaPinene:"-", betaPinene:"X", myrcene:"X", betaCaryophyllene:"X", limonene:"X", terpinolene:"-", alphaHumulene:"-", alphaBisabolol:"-", linalool:"-", ocimene:"-", notes:"Aurora product pages / MedReleaf listing show main terpenes (b-caryophyllene, b-pinene, limonene, myrcene) but no public numeric COA for NZ batches. See Aurora/MedReleaf product listing: https://www.auroramedical.com and https://cannareviews.health/product/medreleaf-sedaprem-indica-vapes-05g"},

  {product:"Bloom Pink Kush", total:"X", alphaPinene:"-", betaPinene:"-", myrcene:"X", betaCaryophyllene:"X", limonene:"X", terpinolene:"-", alphaHumulene:"X", alphaBisabolol:"-", linalool:"X", ocimene:"-", notes:"Bloom / Medleaf strain info sheet lists main terpenes (Caryophyllene, Farnesene, Myrcene, Limonene, Humulene, Linalool) but no public numeric COA PDF found. Strain info: https://www.scribd.com/document/894747637/J000970-Bloom-Pink-Kush-Strain-Info-Sheet-V3. Vendor pages: e.g. Weedmaps / Bloom brand pages."},

  {product:"Cannasouth Cumulus T17", total:"-", alphaPinene:"-", betaPinene:"-", myrcene:"-", betaCaryophyllene:"-", limonene:"-", terpinolene:"-", alphaHumulene:"-", alphaBisabolol:"-", linalool:"-", ocimene:"-", notes:"No public COA or terpene breakdown located. Company fact sheet / product listing: Cannasouth fact sheet and product page: https://cdn.cannasouth.co.nz/wp-content/uploads/2023/03/17161241/PCN006-0323-Cannasouth-Fact-Sheet.pdf and https://cannaplus.co.nz/cannasouth-cumulus-t17/ (clinic page)"},

];


// Pretty header names
const headerPrettyMap = {
  product: "Product",
  total: "Total terpenes (% w/w)",
  myrcene: "Myrcene",
  alphaPinene: "α-Pinene",
  betaPinene: "β-Pinene",
  betaCaryophyllene: "β-Caryophyllene",
  limonene: "Limonene",
  terpinolene: "Terpinolene",
  alphaHumulene: "α-Humulene",
  alphaBisabolol: "α-Bisabolol",
  linalool: "Linalool",
  ocimene: "Ocimene",
  notes: "Notes / source"
};

// Build dynamic table
function buildDynamicTable(data){
  const table = document.getElementById('terpTable');
  const thead = table.querySelector('thead');
  const tbody = table.querySelector('tbody');
  tbody.innerHTML = '';
  thead.innerHTML = '';

  if(!data.length) return;

  // 1️⃣ Collect all unique keys from data
  const keysSet = new Set();
  data.forEach(item => Object.keys(item).forEach(k => keysSet.add(k)));

  // 2️⃣ Sort keys: preferred first, then others alphabetically, notes last
  const preferredOrder = ["product","total","myrcene","alphaPinene","betaPinene","betaCaryophyllene","limonene","terpinolene","alphaHumulene","alphaBisabolol","linalool","ocimene"];
  const keys = Array.from(keysSet).sort((a,b)=>{
    if(a === 'notes') return 1;
    if(b === 'notes') return -1;
    const iA = preferredOrder.indexOf(a);
    const iB = preferredOrder.indexOf(b);
    if(iA!==-1 && iB!==-1) return iA-iB;
    if(iA!==-1) return -1;
    if(iB!==-1) return 1;
    return a.localeCompare(b);
  });

  // 3️⃣ Build header
  const trHead = document.createElement('tr');
  keys.forEach(k=>{
    const th = document.createElement('th');
    th.textContent = headerPrettyMap[k] || k.replace(/([A-Z])/g," $1").replace(/^./,s=>s.toUpperCase());
    th.dataset.type = (k==='product' || k==='notes') ? 'text':'num';
    if(th.dataset.type==='num') th.className='terpene-col';
    trHead.appendChild(th);
  });
  thead.appendChild(trHead);

  // 4️⃣ Build rows
  data.forEach(item=>{
    const tr = document.createElement('tr');
    keys.forEach(k=>{
      let val = item[k]!==undefined ? item[k] : '-';
      const thType = trHead.querySelector(`th:nth-child(${keys.indexOf(k)+1})`).dataset.type;
      if(thType==='num'){
        const numVal = (val==='-'||isNaN(parseFloat(val))) ? 0 : parseFloat(val);
        const displayVal = (val==='-' ? '-' : parseFloat(val).toFixed(3));
        tr.innerHTML += `<td class="num terpene-cell" data-value="${numVal}">${displayVal}</td>`;
      } else {
        tr.innerHTML += `<td>${val}</td>`;
      }
    });
    tbody.appendChild(tr);
  });

  shadeTerpeneColumns();
  attachSorting();
}

// Shade numeric columns
function shadeTerpeneColumns(){
  const table = document.getElementById('terpTable');
  const tbody = table.querySelector('tbody');
  const ths = table.querySelectorAll('th');
  const terpCols = Array.from(ths).map((th,i)=>i).filter(i=>ths[i].dataset.type==='num');

  terpCols.forEach(colIdx=>{
    const cells = Array.from(tbody.rows).map(r=>r.cells[colIdx]);
    const numericCells = cells.filter(c=>parseFloat(c.dataset.value)>0);
    if(!numericCells.length) return;
    const values = numericCells.map(c=>parseFloat(c.dataset.value));
    const minVal = Math.min(...values);
    const maxVal = Math.max(...values);
    const range = maxVal-minVal || 1;
    cells.forEach(cell=>{
      const val = parseFloat(cell.dataset.value);
      if(isNaN(val)||val<=0) cell.style.backgroundColor='';
      else{
        const intensity = 0.3 + 0.7*((val-minVal)/range);
        cell.style.backgroundColor=`rgba(0,128,0,${intensity})`;
      }
    });
  });
}

// Sorting
function attachSorting(){
  const table = document.getElementById('terpTable');
  const ths = table.querySelectorAll('th');
  ths.forEach((th,idx)=>{
    th.onclick = ()=>{
      const type = th.dataset.type || 'text';
      sortTableByColumn(idx,type);
      shadeTerpeneColumns();
    }
  });

  function parseVal(v,type){ return type==='num'? (isNaN(parseFloat(v))?-1:parseFloat(v)) : v.toString().toLowerCase(); }

  function sortTableByColumn(colIdx,type){
    const tbody = table.tBodies[0];
    const rows = Array.from(tbody.rows);
    const asc = table.dataset.sortCol==colIdx && table.dataset.sortDir=='asc'?false:true;
    rows.sort((a,b)=>{
      const A=parseVal(a.cells[colIdx].dataset.value||a.cells[colIdx].textContent,type);
      const B=parseVal(b.cells[colIdx].dataset.value||b.cells[colIdx].textContent,type);
      if(type==='num') return asc?A-B:B-A;
      return asc?(A<B?-1:1):(A<B?1:-1);
    });
    rows.forEach(r=>tbody.appendChild(r));
    table.dataset.sortCol=colIdx;
    table.dataset.sortDir=asc?'asc':'desc';
  }
}

// Init
buildDynamicTable(dataBatch1);
</script>
</body>
</html>
