<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>NZ Medicinal Cannabis Terpenes</title>
<style>
body{font-family:Inter, Roboto, Arial, sans-serif;padding:18px;background:#f7f7fb;color:#111}
h1{font-size:14px;margin-bottom:6px}
table{border-collapse:collapse;width:100%;background:#fff;border:1px solid #e1e4ef;font-size:10px}
th, td{padding:8px 10px;border-bottom:1px solid #eef0f6;border-right:1px solid #eef0f6;text-align:center}
th:last-child, td:last-child{border-right:none;text-align:left}
th{background:#fafbff;position:sticky;top:0;z-index:2;text-align:center;cursor:pointer}
th:first-child, td:first-child{text-align:left}
tr:hover td{background:#fcfdff}
.note{font-size:10px;color:#444;text-align:left}
.small{font-size:10px;color:#666}
.num{white-space:nowrap}
.terpene-cell{color:#111}
.terpene-col{width:60px;min-width:60px;max-width:60px}
</style>
</head>
<body>
<h1>NZ Medicinal Cannabis Terpenes</h1>
<p class="small">Click any column header to sort</p>

<table id="terpTable">
  <thead>
    <tr>
      <th data-type="text">Product</th>
      <th class="terpene-col" data-type="num">Total terpenes (% w/w)</th>
      <th class="terpene-col" data-type="num">Myrcene</th>
      <th class="terpene-col" data-type="num">α-Pinene</th>
      <th class="terpene-col" data-type="num">β-Pinene</th>
      <th class="terpene-col" data-type="num">β-Caryophyllene</th>
      <th class="terpene-col" data-type="num">Limonene</th>
      <th class="terpene-col" data-type="num">Terpinolene</th>
      <th class="terpene-col" data-type="num">α-Humulene</th>
      <th class="terpene-col" data-type="num">α-Bisabolol</th>
      <th class="terpene-col" data-type="num">Linalool</th>
      <th class="terpene-col" data-type="num">Ocimene</th>
      <th data-type="text">Notes / source</th>
    </tr>
  </thead>
  <tbody>
  </tbody>
</table>

<script>
const dataBatch1 = [
  {product:"ANTG Duke", total:"-", alphaPinene:"-", betaPinene:"-", myrcene:"-", betaCaryophyllene:"-", limonene:"-", terpinolene:"-", alphaHumulene:"-", alphaBisabolol:"-", linalool:"-", ocimene:"-", notes:"https://cannareviews.health/product/antg-duke-thc28-flower-10g (product page; no numeric terpene COA found)" },
  {product:"ANTG Eve", total:"-", alphaPinene:"-", betaPinene:"-", myrcene:"-", betaCaryophyllene:"-", limonene:"-", terpinolene:"-", alphaHumulene:"-", alphaBisabolol:"-", linalool:"-", ocimene:"-", notes:"ANTG product references (no public numeric terpene COA found): https://antg.com.au" },
  {product:"ANTG Juno", total:"6.700", alphaPinene:"-", betaPinene:"-", myrcene:"2.300", betaCaryophyllene:"1.600", limonene:"0.500", terpinolene:"-", alphaHumulene:"0.600", alphaBisabolol:"0.300", linalool:"0.700", ocimene:"-", notes:"COA / product listing with numeric terpene values. Source: cannareviews product page listing terpene % (see COA link in product page). https://cannareviews.health/product/antg-juno-thc115cbd125-flower-10g ; (COA copy): https://myleaf.com.au/wp-content/uploads/2023/08/antg-juno-coa.pdf" },
  {product:"ANTG Mariposa", total:"-", alphaPinene:"-", betaPinene:"-", myrcene:"-", betaCaryophyllene:"-", limonene:"-", terpinolene:"-", alphaHumulene:"-", alphaBisabolol:"-", linalool:"-", ocimene:"-", notes:"product page (descriptive terpene/aroma only): https://cannareviews.health/product/antg-mariposa-thc16-flower-10g" },
  {product:"ANTG Rocky", total:"21.800", alphaPinene:"-", betaPinene:"1.100", myrcene:"1.200", betaCaryophyllene:"8.300", limonene:"4.700", terpinolene:"-", alphaHumulene:"2.200", alphaBisabolol:"1.400", linalool:"2.900", ocimene:"-", notes:"Numeric terpene breakdown on product page (values reported as % w/w). Source: https://cannareviews.health/product/antg-rocky-thc30-flower-10g" },
  {product:"ANTG Solace", total:"2.420", alphaPinene:"0.102", betaPinene:"0.109", myrcene:"0.177", betaCaryophyllene:"0.428", limonene:"0.428", terpinolene:"-", alphaHumulene:"0.201", alphaBisabolol:"-", linalool:"0.177", ocimene:"-", notes:"ANTG terpene wheel (gives % of total terpenes and total terpene % = 2.42%). Numeric %w/w calculated from that wheel (see source). https://www.nubupharma.com/wp-content/uploads/2023/07/13869-Standardised-Terpene-Wheels-FINAL.pdf" },
  {product:"Aurora Luminarium", total:"-", alphaPinene:"-", betaPinene:"-", myrcene:"-", betaCaryophyllene:"-", limonene:"-", terpinolene:"-", alphaHumulene:"-", alphaBisabolol:"-", linalool:"-", ocimene:"-", notes:"Aurora product page lists dominant terpenes as terpinolene, β-myrcene and α-pinene but shows no numeric COA on public page: https://www.auroramedical.com/products/luminarium ; also Luminarium oil product page mentions same terpenes: https://www.auroramedical.com/products/luminarium-oil-2-0" },
  {product:"Aurora Sedaprem", total:"-", alphaPinene:"-", betaPinene:"-", myrcene:"-", betaCaryophyllene:"-", limonene:"-", terpinolene:"-", alphaHumulene:"-", alphaBisabolol:"-", linalool:"-", ocimene:"-", notes:"Aurora Sedaprem product pages / clinic listings mention pine/citrus aroma; no public numeric terpene COA found. Example clinic page (login required): https://cannaplus.co.nz/products-driedflower/aurora-sedaprem/" },
  {product:"Bloom Pink Kush", total:"-", alphaPinene:"-", betaPinene:"-", myrcene:"-", betaCaryophyllene:"-", limonene:"-", terpinolene:"-", alphaHumulene:"-", alphaBisabolol:"-", linalool:"-", ocimene:"-", notes:"Bloom Pink Kush (product / strain). Strain-level terpene ordering (myrcene > limonene > caryophyllene) but no public product COA found for NZ batch — strain info reference: https://www.leafly.com/strains/pink-kush and Bloom product pages/socials" },
  {product:"Cannasouth Cumulus T17", total:"-", alphaPinene:"-", betaPinene:"-", myrcene:"-", betaCaryophyllene:"-", limonene:"-", terpinolene:"-", alphaHumulene:"-", alphaBisabolol:"-", linalool:"-", ocimene:"-", notes:"Cannasouth product listing / community posts mention Cumulus T17 (mix of Symetis T17 B52 and Symetis T17 Gorilla). No public numeric terpene COA located. Clinic listing (login): https://cannaplus.co.nz/cannasouth-cumulus-t17/ ; discussion: https://thedailyblog.co.nz/2023/11/04/marijuana-media-police-trial-drones-to-hunt-cannabis-sungrown-nz-bud-available-on-prescription-first-cbd-medicine-approved/" },
];


// Pretty header names
const headerPrettyMap = {
  product: "Product",
  total: "Total terpenes (% w/w)",
  myrcene: "Myrcene",
  alphaPinene: "α-Pinene",
  betaPinene: "β-Pinene",
  betaCaryophyllene: "β-Caryophyllene",
  limonene: "Limonene",
  terpinolene: "Terpinolene",
  alphaHumulene: "α-Humulene",
  alphaBisabolol: "α-Bisabolol",
  linalool: "Linalool",
  ocimene: "Ocimene",
  notes: "Notes / source"
};

// Build dynamic table
function buildDynamicTable(data){
  const table = document.getElementById('terpTable');
  const thead = table.querySelector('thead');
  const tbody = table.querySelector('tbody');
  tbody.innerHTML = '';
  thead.innerHTML = '';

  if(!data.length) return;

  // 1️⃣ Collect all unique keys from data
  const keysSet = new Set();
  data.forEach(item => Object.keys(item).forEach(k => keysSet.add(k)));

  // 2️⃣ Sort keys: preferred first, then others alphabetically, notes last
  const preferredOrder = ["product","total","myrcene","alphaPinene","betaPinene","betaCaryophyllene","limonene","terpinolene","alphaHumulene","alphaBisabolol","linalool","ocimene"];
  const keys = Array.from(keysSet).sort((a,b)=>{
    if(a === 'notes') return 1;
    if(b === 'notes') return -1;
    const iA = preferredOrder.indexOf(a);
    const iB = preferredOrder.indexOf(b);
    if(iA!==-1 && iB!==-1) return iA-iB;
    if(iA!==-1) return -1;
    if(iB!==-1) return 1;
    return a.localeCompare(b);
  });

  // 3️⃣ Build header
  const trHead = document.createElement('tr');
  keys.forEach(k=>{
    const th = document.createElement('th');
    th.textContent = headerPrettyMap[k] || k.replace(/([A-Z])/g," $1").replace(/^./,s=>s.toUpperCase());
    th.dataset.type = (k==='product' || k==='notes') ? 'text':'num';
    if(th.dataset.type==='num') th.className='terpene-col';
    trHead.appendChild(th);
  });
  thead.appendChild(trHead);

  // 4️⃣ Build rows
  data.forEach(item=>{
    const tr = document.createElement('tr');
    keys.forEach(k=>{
      let val = item[k]!==undefined ? item[k] : '-';
      const thType = trHead.querySelector(`th:nth-child(${keys.indexOf(k)+1})`).dataset.type;
      if(thType==='num'){
        const numVal = (val==='-'||isNaN(parseFloat(val))) ? 0 : parseFloat(val);
        const displayVal = (val==='-' ? '-' : parseFloat(val).toFixed(3));
        tr.innerHTML += `<td class="num terpene-cell" data-value="${numVal}">${displayVal}</td>`;
      } else {
        tr.innerHTML += `<td>${val}</td>`;
      }
    });
    tbody.appendChild(tr);
  });

  shadeTerpeneColumns();
  attachSorting();
}

// Shade numeric columns
function shadeTerpeneColumns(){
  const table = document.getElementById('terpTable');
  const tbody = table.querySelector('tbody');
  const ths = table.querySelectorAll('th');
  const terpCols = Array.from(ths).map((th,i)=>i).filter(i=>ths[i].dataset.type==='num');

  terpCols.forEach(colIdx=>{
    const cells = Array.from(tbody.rows).map(r=>r.cells[colIdx]);
    const numericCells = cells.filter(c=>parseFloat(c.dataset.value)>0);
    if(!numericCells.length) return;
    const values = numericCells.map(c=>parseFloat(c.dataset.value));
    const minVal = Math.min(...values);
    const maxVal = Math.max(...values);
    const range = maxVal-minVal || 1;
    cells.forEach(cell=>{
      const val = parseFloat(cell.dataset.value);
      if(isNaN(val)||val<=0) cell.style.backgroundColor='';
      else{
        const intensity = 0.3 + 0.7*((val-minVal)/range);
        cell.style.backgroundColor=`rgba(0,128,0,${intensity})`;
      }
    });
  });
}

// Sorting
function attachSorting(){
  const table = document.getElementById('terpTable');
  const ths = table.querySelectorAll('th');
  ths.forEach((th,idx)=>{
    th.onclick = ()=>{
      const type = th.dataset.type || 'text';
      sortTableByColumn(idx,type);
      shadeTerpeneColumns();
    }
  });

  function parseVal(v,type){ return type==='num'? (isNaN(parseFloat(v))?-1:parseFloat(v)) : v.toString().toLowerCase(); }

  function sortTableByColumn(colIdx,type){
    const tbody = table.tBodies[0];
    const rows = Array.from(tbody.rows);
    const asc = table.dataset.sortCol==colIdx && table.dataset.sortDir=='asc'?false:true;
    rows.sort((a,b)=>{
      const A=parseVal(a.cells[colIdx].dataset.value||a.cells[colIdx].textContent,type);
      const B=parseVal(b.cells[colIdx].dataset.value||b.cells[colIdx].textContent,type);
      if(type==='num') return asc?A-B:B-A;
      return asc?(A<B?-1:1):(A<B?1:-1);
    });
    rows.forEach(r=>tbody.appendChild(r));
    table.dataset.sortCol=colIdx;
    table.dataset.sortDir=asc?'asc':'desc';
  }
}

// Init
buildDynamicTable(dataBatch1);
</script>
</body>
</html>
